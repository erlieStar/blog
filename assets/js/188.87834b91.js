(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{584:function(t,s,a){"use strict";a.r(s);var e=a(56),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"mybatis源码解析-sql解析流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mybatis源码解析-sql解析流程"}},[t._v("#")]),t._v(" Mybatis源码解析：SQL解析流程")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/14ee306c28444c6384263dc2aba9db4c.jpg?",alt:"请添加图片描述"}})]),t._v(" "),a("h2",{attrs:{id:"sql解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql解析"}},[t._v("#")]),t._v(" SQL解析")]),t._v(" "),a("p",[t._v("上一节我们提到在解析的过程中一个比较重要的点是，对每个sql进行解析并封装为SqlSource对象\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/35e72370dd9f49bbb4b17696a5e1f69e.png?",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("sql定义的方式有很多种，比如用xml，@Select，@SelectProvider等来描述要执行的sql，针对不同的定义方式，mybatis定义了不同的SqlSource实现类\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/bb523ece33154774b21d573fd0d4d972.png?",alt:"在这里插入图片描述"}}),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/83ff0c73d346495d8dd97ef5b2176b80.png",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("SqlSource接口只有一个方法，传入sql执行的参数，获取BoundSql\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/a14f0515bf3a40d2b33edb2c7e9ba2c9.png?",alt:"在这里插入图片描述"}}),t._v("\n这个BoundSql我们在参数处理器这一节再分享，你目前只需要知道BoundSql经过参数处理器处理后就能获取到可以执行的sql")]),t._v(" "),a("p",[t._v("常见的SqlSource实现类的作用如下")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("SqlSource")]),t._v(" "),a("th",[t._v("作用")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("DynamicSqlSource")]),t._v(" "),a("td",[t._v("动态sql")])]),t._v(" "),a("tr",[a("td",[t._v("ProviderSqlSource")]),t._v(" "),a("td",[t._v("@*Provider 注解 提供的 SQL ，这种注解在通用mapper中用的最多")])]),t._v(" "),a("tr",[a("td",[t._v("RawSqlSource")]),t._v(" "),a("td",[t._v("静态sql")])]),t._v(" "),a("tr",[a("td",[t._v("StaticSqlSource")]),t._v(" "),a("td",[t._v("仅会含有?的sql")])])])]),t._v(" "),a("p",[t._v("在执行的过程中会把对应的SqlSource都转为StaticSqlSource，StaticSqlSource就是对BoundSql的一个简单封装")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/130559b4c2b44eeebefd230f33192759.png?",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("当然如果你想增加另外一种sql定义的方式，只需要实现SqlSource接口即可。")]),t._v(" "),a("p",[t._v("那么问题来了，既然新写了一种sql定义的方式，那么相应的解析程序也要重新实现，不然mybatis根本不知道如何把你定义的sql翻译为可以执行的sql，此时你只需要重写LanguageDriver接口即可，增加你自己的解析实现")]),t._v(" "),a("p",[t._v("网上就有其他大神，重写了LanguageDriver和SqlSource，利用velocity定义了一套sql的解析流程，但是用的人比较少哈。")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.mybatis.scripting"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("mybatis-velocity"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2.1.0"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("加入依赖后，写出来的sql如下所示，有兴趣的小伙伴可以玩玩。")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"findPerson"')]),t._v(" lang"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"velocity"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#set( $pattern = $_parameter.name + '%' ) ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" person "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("LIKE")]),t._v(" @{pattern"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" jdbcType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VARCHAR")]),t._v("}\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/06374ecd63ec43ceb28e4fcc055b8572.png?",alt:"请添加图片描述"}})]),t._v(" "),a("p",[t._v("LanguageDriver在mybatis中有两个默认实现")]),t._v(" "),a("p",[t._v("XMLLanguageDriver：默认的LanguageDriver，可以处理动态sql和静态sql\nRawLanguageDriver：只可以处理静态sql")]),t._v(" "),a("p",[a("strong",[t._v("那么静态sql和动态sql如何区分呢？")])]),t._v(" "),a("p",[t._v("举个例子，下面这段sql会被解析为如下的语法树")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" age\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" ${tableName}\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"name != null and name != ''\"")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#{name}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"age != null"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" age "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#{age}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" id\n")])])]),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/85c5b9d0f9a14103a7355547ae1cc170.png?",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/5adfa427c1c94b818231431ef9053ad4.png",alt:"请添加图片描述"}})]),t._v(" "),a("p",[t._v("在mybatis中是用SqlNode来解析标签中的内容的，每个不同的标签交给不同的SqlNode来进行解析")]),t._v(" "),a("p",[t._v("SqlNode的定义如下，当执行SqlNode#apply方法时，会把标签解析完的sql放到DynamicContext（当所有标签解析完后，就可以从DynamicContext或获取到只会含有#{}占位符的sql）")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/a2680b798cc9466c981f8f261159e8f0.png",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("常见的SqlNode如下，基本上就是一种标签一个SqlNode，MixedSqlNode是一个比较特殊的标签，它是多个标签的一个组合，因为一个标签下可能有很多子标签，这些子标签会被合并为一个MixedSqlNode，"),a("strong",[t._v("典型的组合模式")]),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/c3c585a4c5d54a2fab3d1d935da0c8b1.png?",alt:"请添加图片描述"}}),t._v("\n一段sql描述会被解析为一个MixedSqlNode，然后基于MixedSqlNode来构建SqlSource")]),t._v(" "),a("p",[t._v("XMLScriptBuilder#parseScriptNode\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/0834ba45ea624c82957890f480743437.png",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("如下为将sql描述转为sql标签的过程")]),t._v(" "),a("p",[t._v("XMLScriptBuilder#parseDynamicTags\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/a3c5455ff0394cf8b2a708941739d7af.png?",alt:"在这里插入图片描述"}}),t._v("\n对应的内容和解析成的SqlNode的对应关系如下")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("内容")]),t._v(" "),a("th",[t._v("解析成的SqlNode")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("if标签中的内容")]),t._v(" "),a("td",[t._v("IfSqlNode")])]),t._v(" "),a("tr",[a("td",[t._v("where标签中的内容")]),t._v(" "),a("td",[t._v("WhereSqlNode")])]),t._v(" "),a("tr",[a("td",[t._v("含有${}占位符的静态文本")]),t._v(" "),a("td",[t._v("TextSqlNode")])]),t._v(" "),a("tr",[a("td",[t._v("纯静态文本或含有#{}占位符")]),t._v(" "),a("td",[t._v("StaticTextSqlNode")])])])]),t._v(" "),a("p",[a("strong",[t._v("从这个解析过程可以看出来，静态sql为纯静态文本或含有#{}占位符的sql，除此之外都是动态sql（如含有${}占位符号，含有动态sql标签）")])]),t._v(" "),a("p",[a("strong",[t._v("静态sql会被封装为RawSqlSource，动态sql会被封装为DynamicSqlSource")]),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/b71225237e0a49d2a9756bfbec470f52.png?",alt:"在这里插入图片描述"}}),t._v(" "),a("strong",[t._v("可以看到静态sql在初始化的时候已经解析完成了")]),t._v("，SqlSourceBuilder会将#{}替换为？，并将#{}中的内容转为ParameterMapping对象")]),t._v(" "),a("p",[t._v("org.apache.ibatis.builder.SqlSourceBuilder#parse\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/701509c640ff45cab84a3d98d7b4458e.png?",alt:"在这里插入图片描述"}}),t._v("\nParameterMappingTokenHandler#handleToken\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/076a5274979e4015b3485a65d687ef31.png",alt:"在这里插入图片描述"}}),t._v("\n我们一般只在#{}中写属性值，但是它其实可以设置很多属性，因此需要转为ParameterMapping对象")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"name != null and name != ''\"")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" #"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("jdbcType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("VARCHAR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("typeHandler"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ibatis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),t._v("StringTypeHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("#{}占位符中可以写的属性如下")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/3302933d38c546b99398cd31516d518d.png",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("将#{}中的内容封装为ParameterMapping对象")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/37e1fb79b53b4820835f2a7da24a7089.png?",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("StaticSqlSource其实就是对BoundSql的一个简单封装\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/645952457c4d44789dda1bd8a9269bab.png?",alt:"在这里插入图片描述"}}),t._v(" "),a("strong",[t._v("动态sql在执行的时候，才会执行解析")]),t._v("，解析的过程和静态sql类似\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/8021b3713b584d8b87860c06efb7eaec.png?",alt:"在这里插入图片描述"}}),t._v(" "),a("strong",[t._v("分析完静态sql和动态sql，我们可以发现静态sql的执行效率比动态sql的执行效率高，因为静态sql在初始化的时候已经解析完成了，动态sql在执行的时候才会解析")])]),t._v(" "),a("h2",{attrs:{id:"sqlnode解析流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sqlnode解析流程"}},[t._v("#")]),t._v(" SqlNode解析流程")]),t._v(" "),a("p",[t._v("最后我们挑几个典型的SqlNode来分析一下解过程")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/b4ce85f5854d41cb97beb22a3c65f871.png",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("StaticTextSqlNode为纯静态文本或含有#{}占位符的节点，所以直接把内容加到容器中就行\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/288aebecfd1f4183ad42267108065404.png?",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("if标签中的表达式为true时，才会将子节点的内容加到DynamicContext中\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/a562be14838248baaf5d88c440de9ea5.png?",alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("foreach标签的解析过程比较麻烦，直接看解析后的结果")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"selectByIds"')]),t._v(" resultType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"org.apache.ibatis.mytest.UserInfo"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("include refid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Base_Column_List"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" user_info "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" id "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("foreach collection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"list"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"("')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("close")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('")"')]),t._v(" separator"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),t._v(" item"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"item"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#{item}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("foreach"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("可以看到将foreach标签被替换为#{}占位符，后续会把sql中名字和值的映射关系放到BoundSql的additionalParameters\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/a8e04e8e4af74cb9b8705baaa4131010.png",alt:"在这里插入图片描述"}}),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/94fc7231414f43e6bd81d36642f23177.png?",alt:"在这里插入图片描述"}}),t._v(" "),a("strong",[t._v("foreach标签的解析流程和设置参数的流程比较耗时间，因此当你的foreach标签中的属性过多时，性能会极速下降，这个需要特别注意，此时你可以选择BatchExecutor来执行sql")])])])}),[],!1,null,null,null);s.default=r.exports}}]);