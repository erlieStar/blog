(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{492:function(s,t,a){"use strict";a.r(t);var e=a(56),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"面试官-redis的基本数据类型都有哪些应用场景啊"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#面试官-redis的基本数据类型都有哪些应用场景啊"}},[s._v("#")]),s._v(" 面试官：Redis的基本数据类型都有哪些应用场景啊？")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200902215745692.png?",alt:"在这里插入图片描述"}})]),s._v(" "),a("h2",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[s._v("#")]),s._v(" 介绍")]),s._v(" "),a("p",[s._v("redis有五种基本数据类型")]),s._v(" "),a("ol",[a("li",[s._v("string（字符串）")]),s._v(" "),a("li",[s._v("hash（哈希）")]),s._v(" "),a("li",[s._v("list（列表）")]),s._v(" "),a("li",[s._v("set（集合）")]),s._v(" "),a("li",[s._v("zset(sorted set：有序集合)")])]),s._v(" "),a("h2",{attrs:{id:"string"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#string"}},[s._v("#")]),s._v(" string")]),s._v(" "),a("p",[a("strong",[s._v("缓存")]),s._v("\n简单key-value存储")]),s._v(" "),a("p",[a("strong",[s._v("分布式锁")]),s._v("\nsetnx key value，当key不存在时，将 key 的值设为 value ，返回1\n若给定的 key 已经存在，则setnx不做任何动作，返回0。")]),s._v(" "),a("p",[s._v("当setnx返回1时，表示获取锁，做完操作以后del key，表示释放锁，如果setnx返回0表示获取锁失败，整体思路大概就是这样")]),s._v(" "),a("p",[a("strong",[s._v("计数器")]),s._v("\n如知乎每个问题的被浏览器次数\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190627212603907.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" key "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nincr key // incr readcount::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("帖子id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" 每阅读一次\nget key // get readcount::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("帖子id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" 获取阅读量\n")])])]),a("p",[a("strong",[s._v("分布式全局唯一id")]),s._v("\n分布式全局唯一id的实现方式有很多，这里只介绍用redis实现\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190627212735819.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("每次获取userId的时候，对userId加1再获取，可以改进为如下形式\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190627212747618.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("直接获取一段userId的最大值，缓存到本地慢慢累加，快到了userId的最大值时，再去获取一段，一个用户服务宕机了，也顶多一小段userId没有用到")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" userId "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nincr usrId //返回1\nincrby userId "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" //返回10001\n")])])]),a("h2",{attrs:{id:"hash"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hash"}},[s._v("#")]),s._v(" hash")]),s._v(" "),a("p",[s._v("redis的散列可以让用户将多个键值对存储到一个Redis的键里面，散列非常适用于将一些相关的数据存储在一起。类似map的一种结构，将结构化的数据，比如一个对象（前提是这个对象没嵌套其他的对象）给缓存到redis中，以后每次读写内存时，就可以操作hash里的某个字段")]),s._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("# 设置用户信息\nhset student name test\nhset student age "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n\n# 获取用户的所有相关信息\nhgetall student\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"age"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10"')]),s._v("\n\n# 重新设置用户的年龄\nhset student age "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\n\n# 获取用户的年龄\nhget student age\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"20"')]),s._v("\n")])])]),a("h2",{attrs:{id:"list"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#list"}},[s._v("#")]),s._v(" list")]),s._v(" "),a("p",[a("strong",[s._v("消息队列")]),s._v("\n在list里面一边进，一边出即可")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 实现方式一")]),s._v("\nlpush key value //一直往list左边放\nbrpop key value "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" \n//key这个list有元素时，直接弹出，没有元素被阻塞，直到等待超时或发现可弹出元素为止，上面例子超时时间为10s\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 实现方式二")]),s._v("\nrpush key value\nblpop key value "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190627212838206.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p6dGlfZXJsaWU=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v(" "),a("strong",[s._v("新浪/Twitter用户消息列表（list）")]),s._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20191009151313265.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p6dGlfZXJsaWU=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v("\n假如说小编li关注了2个微博a和b，a发了一条微博（编号为100）就执行如下命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("lpush msg::li "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n")])])]),a("p",[s._v("b发了一条微博（编号为200）就执行如下命令：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("lpush msg::li "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("\n")])])]),a("p",[s._v("假如想拿最近的10条消息就可以执行如下命令（最新的消息一定在list的最左边）：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("lrange msg::li "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" //下标从0开始，"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("start,stop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("是闭区间，都包含\n")])])]),a("h2",{attrs:{id:"set"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set"}},[s._v("#")]),s._v(" set")]),s._v(" "),a("p",[a("strong",[s._v("去重")]),s._v("\n无序集合，自动去重，将数据放到set中就可去重，可以基于JVM的HashSet去重，如果系统部署在多台机器上，就可以用redis进行全局去重")]),s._v(" "),a("p",[a("strong",[s._v("抽奖活动")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("sadd key "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" // 参加抽奖活动\nsmembers key //获取所有抽奖用户，大轮盘转起来\nspop key count //抽取count名中奖者，并从抽奖活动中移除\nsrandmember key count //抽取count名中奖者，不从抽奖活动中移除\n")])])]),a("p",[a("strong",[s._v("实现点赞，签到，like等功能")]),s._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20191009151729840.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p6dGlfZXJsaWU=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("// "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("用户给8001帖子点赞\nsadd like::8001 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v("\nsrem like::8001 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v(" //取消点赞\nsismember like::8001 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1001")]),s._v(" //检查用户是否点过赞\nsmembers like::8001 //获取点赞的用户列表\nscard like::8001 //获取点赞用户数\n")])])]),a("p",[a("strong",[s._v("实现关注模型，可能认识的人（set）")])]),s._v(" "),a("p",[s._v("可以基于set做交集，并集，差集的操作。如把2个人的粉丝列表弄一个交集，就能看到两个人的共同好友是谁")]),s._v(" "),a("p",[s._v("seven关注的人\nsevenSub -> {qing, mic, james}\n青山关注的人\nqingSub->{seven,jack,mic,james}\nMic关注的人\nMicSub->{seven,james,qing,jack,tom}")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("//返回sevenSub和qingSub的交集，即seven和青山的共同关注\nsinter sevenSub qingSub -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("mic,james"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n// 我关注的人也关注他,下面例子中我是seven\n// qing在micSub中返回1，否则返回0\nsismember micSub qing\nsismember jamesSub qing\n\n// 我可能认识的人,下面例子中我是seven\n// 求qingSub和sevenSub的差集，并存在sevenMayKnow集合中\nsdiffstore sevenMayKnow qingSub sevenSub -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("seven,jack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[a("strong",[s._v("电商商品筛选")]),s._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/2019100915191241.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p6dGlfZXJsaWU=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}}),s._v("\n每个商品入库的时候即会建立他的静态标签列表如，品牌，尺寸，处理器，内存")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("// 将拯救者y700P-001和ThinkPad-T480这两个元素放到集合brand::lenovo\nsadd brand::lenovo 拯救者y700P-001 ThinkPad-T480\nsadd screenSize::15.6 拯救者y700P-001 机械革命Z2AIR\nsadd processor::i7 拯救者y700P-001 机械革命X8TIPlus\n\n// 获取品牌为联想，屏幕尺寸为15.6，并且处理器为i7的电脑品牌"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sinter为获取集合的交集"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsinter brand::lenovo screenSize::15.6 processor::i7 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 拯救者y700P-001\n")])])]),a("h2",{attrs:{id:"zset"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zset"}},[s._v("#")]),s._v(" zset")]),s._v(" "),a("p",[s._v("排序的set，可以去重还可以排序，写进去的时候给一个分数，自动根据根据分数排序，分数可以自定义排序规则")]),s._v(" "),a("p",[s._v("redis的zset天生是用来做排行榜的、好友列表, 去重, 历史记录等业务需求\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190627213440547.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3p6dGlfZXJsaWU=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("// user1的用户分数为 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nzadd ranking "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" user1\nzadd ranking "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v(" user2\n\n// 取分数最高的3个用户\nzrevrange ranking "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" withscores\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);